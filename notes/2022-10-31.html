
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>23. Clustering &#8212; Programming for Data Science at URI Fall 2022</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="24. Clustering with Sci-kit Learn" href="2022-11-02.html" />
    <link rel="prev" title="22. Sparse and Polynomial Regression" href="2022-10-28.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/310_2021.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programming for Data Science at URI Fall 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About this Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/about.html">
   About
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/tools.html">
   Tools and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/achievements.html">
   Data Science Achievements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/grading.html">
   Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/policies.html">
   Grading Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_resources.html">
   Support
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_statements.html">
   General URI Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/communication.html">
   Help Hours and Course Communications
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-07.html">
   1. Welcome to Programming to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-12.html">
   2. Reading Docstrings, Object Inspection, and Loading Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-14.html">
   3. Data Frames and other iterables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-16.html">
   4. Iterables and Indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-19.html">
   5. Getting Started with Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-21.html">
   6. Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-23.html">
   7. More EDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-26.html">
   8. Intro to Data Cleaning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-28.html">
   9. Fixing Data representations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-09-30.html">
   10. Cleaning Data: fixing values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-03.html">
   11. Building Datasets from Multiple Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-05.html">
   12. Web Scraping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-07.html">
   13. Getting Data from Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-12.html">
   14. Intro to Machine Learning: Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-14.html">
   15. Performance Metrics continued
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-17.html">
   16. Modeling and Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-19.html">
   17. Classification with Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-21.html">
   18. Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-24.html">
   19. Feedback &amp; Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-26.html">
   21. Interpretting Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-10-28.html">
   22. Sparse and Polynomial Regression
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   23. Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-02.html">
   24. Clustering with Sci-kit Learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-04.html">
   30. Clutering Evalutation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-07.html">
   31. ML Task Review Cross Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-09.html">
   32. Model Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-14.html">
   33. Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-16.html">
   34. Model Comparison: when do differences matter?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-18.html">
   35. Learning Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-21.html">
   36. Intro to NLP- representing text data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-11-23.html">
   37. Classification of Text Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-12-05.html">
   38. Neural Networks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/01-python-syllabus.html">
   1. Portfolio Setup, Data Science, and Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/02-python-access.html">
   2. Assignment 2: Practicing Python and Accessing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/03-eda.html">
   3. Assignment 3: Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/04-prepare.html">
   4. Assignment 4: Cleaning Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/05-construct.html">
   5. Assignment 5: Constructing Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/06-evaluate.html">
   6. Assignment 6: Auditing Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/07-classification.html">
   7. Assignment 7: Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/08-regression.html">
   8. Assignment 8: Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/09-clustering.html">
   9. Assignment 9
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/10-optimize.html">
   10. Assignment 10: Tuning Model Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/11-compare.html">
   11. Assignment 11 Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/12-fake-news.html">
   12. Assignment 12: Fake News
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Portfolio
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/index.html">
   Portfolio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/formatting.html">
   Formatting Tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check1ideas.html">
   Portfolio Check 1 Ideas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check2ideas.html">
   Check 2 Ideas
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  FAQ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/index.html">
   FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/syllabus.html">
   Syllabus and Grading FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/github.html">
   Git and GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/debugging.html">
   Code Errors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/python.html">
   References on Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/operations.html">
   How Tos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/cheatsheet.html">
   Cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/datasets.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/tips.html">
   General Tips and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/learning.html">
   How to Study in this class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/gettinghelp.html">
   Getting Help with Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/terminal.html">
   Terminals and Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/organization.html">
   Getting Organized for class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall20/letters/">
   Advice from FA2020 Students
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall21/letters/">
   Advice from FA2021 Students
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../letters/index.html">
   Letters to Future students
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/rhodyprog4ds/BrownFall22/main?urlpath=tree/notes/2022-10-31.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownFall22/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownFall22//issues/new?title=Issue%20on%20page%20%2Fnotes/2022-10-31.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownFall22/edit/main/notes/2022-10-31.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notes/2022-10-31.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/notes/2022-10-31.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-does-kmeans-work">
   23.1. How does Kmeans work?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kmeans">
   23.2. Kmeans
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-after-class">
   23.3. Questions After class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#are-there-any-better-way-to-optimize-than-run-multiple-times">
     23.3.1. Are there any better way to optimize than run multiple times?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-use-sklearn-to-cluster-data">
     23.3.2. How do we use sklearn to cluster data?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Clustering</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-does-kmeans-work">
   23.1. How does Kmeans work?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kmeans">
   23.2. Kmeans
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-after-class">
   23.3. Questions After class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#are-there-any-better-way-to-optimize-than-run-multiple-times">
     23.3.1. Are there any better way to optimize than run multiple times?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-use-sklearn-to-cluster-data">
     23.3.2. How do we use sklearn to cluster data?
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="clustering">
<h1><span class="section-number">23. </span>Clustering<a class="headerlink" href="#clustering" title="Permalink to this headline">#</a></h1>
<p>Clustering is unsupervised learning.  That means we do not have the labels to
learn from.  We aim to learn both the labels for each point and some way of
characterizing the classes at the same time.</p>
<p>Computationally, this is a harder problem.  Mathematically, we can
typically solve problems when we have a number of equations equal to or greater
than the number of unknowns.  For <span class="math notranslate nohighlight">\(N\)</span> data points ind <span class="math notranslate nohighlight">\(d\)</span> dimensions and <span class="math notranslate nohighlight">\(K\)</span> clusters, we have <span class="math notranslate nohighlight">\(N\)</span>
equations and <span class="math notranslate nohighlight">\(N + K*d\)</span> unknowns. This means we have a harder problem to solve.</p>
<p>For today, we’ll see K-means clustering which is defined by <span class="math notranslate nohighlight">\(K\)</span> a number of
clusters and a mean (center) for each one.  There are other K-centers algorithms
for other types of centers.</p>
<p>Clustering is a stochastic (random) algorithm, so it can be a little harder to debug the models and measure performance.  For this reason, we are going to lootk a little more closely at what it actuall <em>does</em> than we have with classification or regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
import numpy as np
import itertools as it
import seaborn as sns
from sklearn import datasets
from sklearn.cluster import KMeans
import string
import pandas as pd
</pre></div>
</div>
</div>
</div>
<section id="how-does-kmeans-work">
<h2><span class="section-number">23.1. </span>How does Kmeans work?<a class="headerlink" href="#how-does-kmeans-work" title="Permalink to this headline">#</a></h2>
<p>We will start with some synthetics data and then see how the clustering works.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code should be fairly readable, but is not strictly required.
One tricky part is <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#zip"><code class="docutils literal notranslate"><span class="pre">zip</span></code></a> which is a builtin fuction for iteratinv over groups of things together.</p>
<p>And <a class="reference external" href="https://docs.python.org/3/library/itertools.html"><code class="docutils literal notranslate"><span class="pre">itertools</span></code></a> is a core library for related more iterating.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>C = 4
N = 200
offset = 2
spacing = 2

# choose the first C uppcase letters
classes = list(string.ascii_uppercase[:C])
# get the number of grid locations needed
G = int(np.ceil(np.sqrt(C)))
# get the locations for each axis
grid_locs = a = np.linspace(offset,offset+G*spacing,G)
# compute grid (i,j) for each combination of values above &amp; keep C values
means = [(i,j) for i, j in it.product(grid_locs,grid_locs)][:C]
# store in dictionary with class labels
mu = {c: i for c, i in zip(classes,means)}
# random variances
sigma = {c: i*.5 for c, i in zip(classes,np.random.random(4))}

#randomly choose a class for each point, with equal probability
clusters_true = np.random.choice(classes,N)
# draw a randome point according to the means from above for each point
data = [np.random.multivariate_normal(mu[c],.25*np.eye(2)) for c in clusters_true]
# rounding to make display neater later
df = pd.DataFrame(data = data,columns = [&#39;x&#39; + str(i) for i in range(2)]).round(2)

# store in dataFram
df[&#39;true_cluster&#39;] = clusters_true

sns.pairplot(data =df, hue=&#39;true_cluster&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f3278e1b850&gt;
</pre></div>
</div>
<img alt="../_images/2022-10-31_3_1.png" src="../_images/2022-10-31_3_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x0</th>
      <th>x1</th>
      <th>true_cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.26</td>
      <td>4.56</td>
      <td>D</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.62</td>
      <td>0.89</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.46</td>
      <td>6.63</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.49</td>
      <td>2.78</td>
      <td>C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.93</td>
      <td>1.89</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="kmeans">
<h2><span class="section-number">23.2. </span>Kmeans<a class="headerlink" href="#kmeans" title="Permalink to this headline">#</a></h2>
<p>Next, we’ll pick 4 random points to be the starting points as the means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>K = 4
mu0 = df.sample(n=K).values
mu0
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5.84, 5.59, &#39;D&#39;],
       [2.42, 5.97, &#39;B&#39;],
       [1.81, 6.1, &#39;B&#39;],
       [6.12, 1.42, &#39;C&#39;]], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Now, we will compute, fo each sample which of those four points it is closest to
first by taking the difference, squaring it, then summing along each row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[((df-mu_i)**2).sum(axis=1) for mu_i in mu0]
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:165,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">165</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:241,</span> in <span class="ni">evaluate</span><span class="nt">(op, a, b, use_numexpr)</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="k">if</span> <span class="n">use_numexpr</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>         <span class="c1"># error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">241</span>         <span class="k">return</span> <span class="n">_evaluate</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span> <span class="k">return</span> <span class="n">_evaluate_standard</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:70,</span> in <span class="ni">_evaluate_standard</span><span class="nt">(op, op_str, a, b)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="n">_store_test_result</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">70</span> <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="p">[((</span><span class="n">df</span><span class="o">-</span><span class="n">mu_i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">mu_i</span> <span class="ow">in</span> <span class="n">mu0</span><span class="p">]</span>

<span class="nn">Cell In[5], line 1,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="p">[((</span><span class="n">df</span><span class="o">-</span><span class="n">mu_i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">mu_i</span> <span class="ow">in</span> <span class="n">mu0</span><span class="p">]</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/common.py:72,</span> in <span class="ni">_unpack_zerodim_and_defer.&lt;locals&gt;.new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>             <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">72</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/arraylike.py:110,</span> in <span class="ni">OpsMixin.__sub__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__sub__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">110</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arith_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7591,</span> in <span class="ni">DataFrame._arith_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">7587</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">maybe_prepare_scalar_for_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],))</span>
<span class="g g-Whitespace">   </span><span class="mi">7589</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">align_method_FRAME</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">flex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7591</span> <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch_frame_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7592</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7630,</span> in <span class="ni">DataFrame._dispatch_frame_op</span><span class="nt">(self, right, func, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">7624</span>     <span class="c1"># TODO: The previous assertion `assert right._indexed_same(self)`</span>
<span class="g g-Whitespace">   </span><span class="mi">7625</span>     <span class="c1">#  fails in cases with empty columns reached via</span>
<span class="g g-Whitespace">   </span><span class="mi">7626</span>     <span class="c1">#  _frame_arith_method_with_reindex</span>
<span class="g g-Whitespace">   </span><span class="mi">7627</span> 
<span class="g g-Whitespace">   </span><span class="mi">7628</span>     <span class="c1"># TODO operate_blockwise expects a manager of the same type</span>
<span class="g g-Whitespace">   </span><span class="mi">7629</span>     <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">7630</span>         <span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">operate_blockwise</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">7631</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;ArrayManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7632</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7633</span>             <span class="c1"># &quot;ArrayManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7634</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;BlockManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7635</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7636</span>             <span class="c1"># &quot;BlockManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7637</span>             <span class="n">right</span><span class="o">.</span><span class="n">_mgr</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">   </span><span class="mi">7638</span>             <span class="n">array_op</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">7639</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7640</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="n">bm</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7642</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7643</span>     <span class="c1"># axis=1 means we want to operate row-by-row</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/managers.py:1586,</span> in <span class="ni">BlockManager.operate_blockwise</span><span class="nt">(self, other, array_op)</span>
<span class="g g-Whitespace">   </span><span class="mi">1582</span> <span class="k">def</span> <span class="nf">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">BlockManager</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BlockManager</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1583</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1584</span><span class="sd">     Apply array_op blockwise with another (aligned) BlockManager.</span>
<span class="g g-Whitespace">   </span><span class="mi">1585</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1586</span>     <span class="k">return</span> <span class="n">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/ops.py:63,</span> in <span class="ni">operate_blockwise</span><span class="nt">(left, right, array_op)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="n">res_blks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">for</span> <span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">left_ea</span><span class="p">,</span> <span class="n">right_ea</span><span class="p">,</span> <span class="n">rblk</span> <span class="ow">in</span> <span class="n">_iter_block_pairs</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">63</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">array_op</span><span class="p">(</span><span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="k">if</span> <span class="n">left_ea</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">right_ea</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="s2">&quot;reshape&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">res_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:226,</span> in <span class="ni">arithmetic_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="n">_bool_arith_check</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="c1"># error: Argument 1 to &quot;_na_arithmetic_op&quot; has incompatible type</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># &quot;Union[ExtensionArray, ndarray[Any, Any]]&quot;; expected &quot;ndarray[Any, Any]&quot;</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">_na_arithmetic_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> <span class="k">return</span> <span class="n">res_values</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:172,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_cmp</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_object_dtype</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_object_dtype</span><span class="p">(</span><span class="n">right</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span>         <span class="c1"># For object dtype, fallback to a masked operation (only operating</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>         <span class="c1">#  on the non-missing values)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>         <span class="c1"># Don&#39;t do this for comparisons, as that will handle complex numbers</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span>         <span class="c1">#  incorrectly, see GH#32047</span>
<span class="ne">--&gt; </span><span class="mi">172</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">_masked_arith_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>         <span class="k">raise</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:110,</span> in <span class="ni">_masked_arith_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="c1"># See GH#5284, GH#5035, GH#19448 for historical reference</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">result</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">xrav</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">yrav</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;
</pre></div>
</div>
</div>
</div>
<p>This gives us a list of 4 data DataFrames, one for each mean (mu), with one row
for each point in the dataset with the distance from that point to the
corresponding mean. We can stack these into one DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i in mu0],axis=1).head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:165,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">165</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:241,</span> in <span class="ni">evaluate</span><span class="nt">(op, a, b, use_numexpr)</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="k">if</span> <span class="n">use_numexpr</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>         <span class="c1"># error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">241</span>         <span class="k">return</span> <span class="n">_evaluate</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span> <span class="k">return</span> <span class="n">_evaluate_standard</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:70,</span> in <span class="ni">_evaluate_standard</span><span class="nt">(op, op_str, a, b)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="n">_store_test_result</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">70</span> <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu0],axis=1).head</span><span class="nt">()</span>

<span class="nn">Cell In[6], line 1,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="nn">----&gt; 1 pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu0],axis=1).head</span><span class="nt">()</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/common.py:72,</span> in <span class="ni">_unpack_zerodim_and_defer.&lt;locals&gt;.new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>             <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">72</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/arraylike.py:110,</span> in <span class="ni">OpsMixin.__sub__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__sub__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">110</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arith_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7591,</span> in <span class="ni">DataFrame._arith_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">7587</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">maybe_prepare_scalar_for_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],))</span>
<span class="g g-Whitespace">   </span><span class="mi">7589</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">align_method_FRAME</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">flex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7591</span> <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch_frame_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7592</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7630,</span> in <span class="ni">DataFrame._dispatch_frame_op</span><span class="nt">(self, right, func, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">7624</span>     <span class="c1"># TODO: The previous assertion `assert right._indexed_same(self)`</span>
<span class="g g-Whitespace">   </span><span class="mi">7625</span>     <span class="c1">#  fails in cases with empty columns reached via</span>
<span class="g g-Whitespace">   </span><span class="mi">7626</span>     <span class="c1">#  _frame_arith_method_with_reindex</span>
<span class="g g-Whitespace">   </span><span class="mi">7627</span> 
<span class="g g-Whitespace">   </span><span class="mi">7628</span>     <span class="c1"># TODO operate_blockwise expects a manager of the same type</span>
<span class="g g-Whitespace">   </span><span class="mi">7629</span>     <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">7630</span>         <span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">operate_blockwise</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">7631</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;ArrayManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7632</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7633</span>             <span class="c1"># &quot;ArrayManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7634</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;BlockManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7635</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7636</span>             <span class="c1"># &quot;BlockManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7637</span>             <span class="n">right</span><span class="o">.</span><span class="n">_mgr</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">   </span><span class="mi">7638</span>             <span class="n">array_op</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">7639</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7640</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="n">bm</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7642</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7643</span>     <span class="c1"># axis=1 means we want to operate row-by-row</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/managers.py:1586,</span> in <span class="ni">BlockManager.operate_blockwise</span><span class="nt">(self, other, array_op)</span>
<span class="g g-Whitespace">   </span><span class="mi">1582</span> <span class="k">def</span> <span class="nf">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">BlockManager</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BlockManager</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1583</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1584</span><span class="sd">     Apply array_op blockwise with another (aligned) BlockManager.</span>
<span class="g g-Whitespace">   </span><span class="mi">1585</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1586</span>     <span class="k">return</span> <span class="n">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/ops.py:63,</span> in <span class="ni">operate_blockwise</span><span class="nt">(left, right, array_op)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="n">res_blks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">for</span> <span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">left_ea</span><span class="p">,</span> <span class="n">right_ea</span><span class="p">,</span> <span class="n">rblk</span> <span class="ow">in</span> <span class="n">_iter_block_pairs</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">63</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">array_op</span><span class="p">(</span><span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="k">if</span> <span class="n">left_ea</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">right_ea</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="s2">&quot;reshape&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">res_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:226,</span> in <span class="ni">arithmetic_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="n">_bool_arith_check</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="c1"># error: Argument 1 to &quot;_na_arithmetic_op&quot; has incompatible type</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># &quot;Union[ExtensionArray, ndarray[Any, Any]]&quot;; expected &quot;ndarray[Any, Any]&quot;</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">_na_arithmetic_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> <span class="k">return</span> <span class="n">res_values</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:172,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_cmp</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_object_dtype</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_object_dtype</span><span class="p">(</span><span class="n">right</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span>         <span class="c1"># For object dtype, fallback to a masked operation (only operating</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>         <span class="c1">#  on the non-missing values)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>         <span class="c1"># Don&#39;t do this for comparisons, as that will handle complex numbers</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span>         <span class="c1">#  incorrectly, see GH#32047</span>
<span class="ne">--&gt; </span><span class="mi">172</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">_masked_arith_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>         <span class="k">raise</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:110,</span> in <span class="ni">_masked_arith_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="c1"># See GH#5284, GH#5035, GH#19448 for historical reference</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">result</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">xrav</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">yrav</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;
</pre></div>
</div>
</div>
</div>
<p>Now we have one row per sample and one column per mean, with with the distance from that point to the mean. What we want is to calculate the assignment, which
mean is closest, for each point.  Using <code class="docutils literal notranslate"><span class="pre">idxmin</span></code> with <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> we take the
minimum across each row and returns the index (location) of that minimum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i in mu0],axis=1).idxmin(axis=1).head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:165,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">165</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:241,</span> in <span class="ni">evaluate</span><span class="nt">(op, a, b, use_numexpr)</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="k">if</span> <span class="n">use_numexpr</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>         <span class="c1"># error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">241</span>         <span class="k">return</span> <span class="n">_evaluate</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span> <span class="k">return</span> <span class="n">_evaluate_standard</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:70,</span> in <span class="ni">_evaluate_standard</span><span class="nt">(op, op_str, a, b)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="n">_store_test_result</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">70</span> <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu0],axis=1).idxmin(axis=1).head</span><span class="nt">()</span>

<span class="nn">Cell In[7], line 1,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="nn">----&gt; 1 pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu0],axis=1).idxmin(axis=1).head</span><span class="nt">()</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/common.py:72,</span> in <span class="ni">_unpack_zerodim_and_defer.&lt;locals&gt;.new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>             <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">72</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/arraylike.py:110,</span> in <span class="ni">OpsMixin.__sub__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__sub__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">110</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arith_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7591,</span> in <span class="ni">DataFrame._arith_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">7587</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">maybe_prepare_scalar_for_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],))</span>
<span class="g g-Whitespace">   </span><span class="mi">7589</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">align_method_FRAME</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">flex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7591</span> <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch_frame_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7592</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7630,</span> in <span class="ni">DataFrame._dispatch_frame_op</span><span class="nt">(self, right, func, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">7624</span>     <span class="c1"># TODO: The previous assertion `assert right._indexed_same(self)`</span>
<span class="g g-Whitespace">   </span><span class="mi">7625</span>     <span class="c1">#  fails in cases with empty columns reached via</span>
<span class="g g-Whitespace">   </span><span class="mi">7626</span>     <span class="c1">#  _frame_arith_method_with_reindex</span>
<span class="g g-Whitespace">   </span><span class="mi">7627</span> 
<span class="g g-Whitespace">   </span><span class="mi">7628</span>     <span class="c1"># TODO operate_blockwise expects a manager of the same type</span>
<span class="g g-Whitespace">   </span><span class="mi">7629</span>     <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">7630</span>         <span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">operate_blockwise</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">7631</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;ArrayManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7632</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7633</span>             <span class="c1"># &quot;ArrayManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7634</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;BlockManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7635</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7636</span>             <span class="c1"># &quot;BlockManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7637</span>             <span class="n">right</span><span class="o">.</span><span class="n">_mgr</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">   </span><span class="mi">7638</span>             <span class="n">array_op</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">7639</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7640</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="n">bm</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7642</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7643</span>     <span class="c1"># axis=1 means we want to operate row-by-row</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/managers.py:1586,</span> in <span class="ni">BlockManager.operate_blockwise</span><span class="nt">(self, other, array_op)</span>
<span class="g g-Whitespace">   </span><span class="mi">1582</span> <span class="k">def</span> <span class="nf">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">BlockManager</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BlockManager</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1583</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1584</span><span class="sd">     Apply array_op blockwise with another (aligned) BlockManager.</span>
<span class="g g-Whitespace">   </span><span class="mi">1585</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1586</span>     <span class="k">return</span> <span class="n">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/ops.py:63,</span> in <span class="ni">operate_blockwise</span><span class="nt">(left, right, array_op)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="n">res_blks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">for</span> <span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">left_ea</span><span class="p">,</span> <span class="n">right_ea</span><span class="p">,</span> <span class="n">rblk</span> <span class="ow">in</span> <span class="n">_iter_block_pairs</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">63</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">array_op</span><span class="p">(</span><span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="k">if</span> <span class="n">left_ea</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">right_ea</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="s2">&quot;reshape&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">res_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:226,</span> in <span class="ni">arithmetic_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="n">_bool_arith_check</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="c1"># error: Argument 1 to &quot;_na_arithmetic_op&quot; has incompatible type</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># &quot;Union[ExtensionArray, ndarray[Any, Any]]&quot;; expected &quot;ndarray[Any, Any]&quot;</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">_na_arithmetic_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> <span class="k">return</span> <span class="n">res_values</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:172,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_cmp</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_object_dtype</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_object_dtype</span><span class="p">(</span><span class="n">right</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span>         <span class="c1"># For object dtype, fallback to a masked operation (only operating</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>         <span class="c1">#  on the non-missing values)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>         <span class="c1"># Don&#39;t do this for comparisons, as that will handle complex numbers</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span>         <span class="c1">#  incorrectly, see GH#32047</span>
<span class="ne">--&gt; </span><span class="mi">172</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">_masked_arith_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>         <span class="k">raise</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:110,</span> in <span class="ni">_masked_arith_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="c1"># See GH#5284, GH#5035, GH#19448 for historical reference</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">result</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">xrav</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">yrav</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;
</pre></div>
</div>
</div>
</div>
<p>We’ll save all of this in a column named <code class="docutils literal notranslate"><span class="pre">'0'</span></code>. Since it is our 0th iteration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df[&#39;0&#39;] = pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i in mu0],axis=1).idxmin(axis=1)

df.head()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:165,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">165</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:241,</span> in <span class="ni">evaluate</span><span class="nt">(op, a, b, use_numexpr)</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="k">if</span> <span class="n">use_numexpr</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>         <span class="c1"># error: &quot;None&quot; not callable</span>
<span class="ne">--&gt; </span><span class="mi">241</span>         <span class="k">return</span> <span class="n">_evaluate</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span> <span class="k">return</span> <span class="n">_evaluate_standard</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">op_str</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/computation/expressions.py:70,</span> in <span class="ni">_evaluate_standard</span><span class="nt">(op, op_str, a, b)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="n">_store_test_result</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">70</span> <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 df[&#39;0&#39;] = pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu0],axis=1).idxmin</span><span class="nt">(axis=1)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">Cell In[8], line 1,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="nn">----&gt; 1 df[&#39;0&#39;] = pd.concat([((df-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu0],axis=1).idxmin</span><span class="nt">(axis=1)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/common.py:72,</span> in <span class="ni">_unpack_zerodim_and_defer.&lt;locals&gt;.new_method</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>             <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span> <span class="n">other</span> <span class="o">=</span> <span class="n">item_from_zerodim</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">72</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/arraylike.py:110,</span> in <span class="ni">OpsMixin.__sub__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="nd">@unpack_zerodim_and_defer</span><span class="p">(</span><span class="s2">&quot;__sub__&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">110</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arith_method</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7591,</span> in <span class="ni">DataFrame._arith_method</span><span class="nt">(self, other, op)</span>
<span class="g g-Whitespace">   </span><span class="mi">7587</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">maybe_prepare_scalar_for_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],))</span>
<span class="g g-Whitespace">   </span><span class="mi">7589</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">align_method_FRAME</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">flex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7591</span> <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispatch_frame_op</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7592</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_result</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:7630,</span> in <span class="ni">DataFrame._dispatch_frame_op</span><span class="nt">(self, right, func, axis)</span>
<span class="g g-Whitespace">   </span><span class="mi">7624</span>     <span class="c1"># TODO: The previous assertion `assert right._indexed_same(self)`</span>
<span class="g g-Whitespace">   </span><span class="mi">7625</span>     <span class="c1">#  fails in cases with empty columns reached via</span>
<span class="g g-Whitespace">   </span><span class="mi">7626</span>     <span class="c1">#  _frame_arith_method_with_reindex</span>
<span class="g g-Whitespace">   </span><span class="mi">7627</span> 
<span class="g g-Whitespace">   </span><span class="mi">7628</span>     <span class="c1"># TODO operate_blockwise expects a manager of the same type</span>
<span class="g g-Whitespace">   </span><span class="mi">7629</span>     <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">7630</span>         <span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">operate_blockwise</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">7631</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;ArrayManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7632</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7633</span>             <span class="c1"># &quot;ArrayManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7634</span>             <span class="c1"># error: Argument 1 to &quot;operate_blockwise&quot; of &quot;BlockManager&quot; has</span>
<span class="g g-Whitespace">   </span><span class="mi">7635</span>             <span class="c1"># incompatible type &quot;Union[ArrayManager, BlockManager]&quot;; expected</span>
<span class="g g-Whitespace">   </span><span class="mi">7636</span>             <span class="c1"># &quot;BlockManager&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">7637</span>             <span class="n">right</span><span class="o">.</span><span class="n">_mgr</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">   </span><span class="mi">7638</span>             <span class="n">array_op</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">7639</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7640</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="n">bm</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7642</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7643</span>     <span class="c1"># axis=1 means we want to operate row-by-row</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/managers.py:1586,</span> in <span class="ni">BlockManager.operate_blockwise</span><span class="nt">(self, other, array_op)</span>
<span class="g g-Whitespace">   </span><span class="mi">1582</span> <span class="k">def</span> <span class="nf">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">BlockManager</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BlockManager</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1583</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1584</span><span class="sd">     Apply array_op blockwise with another (aligned) BlockManager.</span>
<span class="g g-Whitespace">   </span><span class="mi">1585</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1586</span>     <span class="k">return</span> <span class="n">operate_blockwise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">array_op</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/ops.py:63,</span> in <span class="ni">operate_blockwise</span><span class="nt">(left, right, array_op)</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span> <span class="n">res_blks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">for</span> <span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">left_ea</span><span class="p">,</span> <span class="n">right_ea</span><span class="p">,</span> <span class="n">rblk</span> <span class="ow">in</span> <span class="n">_iter_block_pairs</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">63</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">array_op</span><span class="p">(</span><span class="n">lvals</span><span class="p">,</span> <span class="n">rvals</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="k">if</span> <span class="n">left_ea</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">right_ea</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res_values</span><span class="p">,</span> <span class="s2">&quot;reshape&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span>         <span class="n">res_values</span> <span class="o">=</span> <span class="n">res_values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:226,</span> in <span class="ni">arithmetic_op</span><span class="nt">(left, right, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="n">_bool_arith_check</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>     <span class="c1"># error: Argument 1 to &quot;_na_arithmetic_op&quot; has incompatible type</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="c1"># &quot;Union[ExtensionArray, ndarray[Any, Any]]&quot;; expected &quot;ndarray[Any, Any]&quot;</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="n">res_values</span> <span class="o">=</span> <span class="n">_na_arithmetic_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> <span class="k">return</span> <span class="n">res_values</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:172,</span> in <span class="ni">_na_arithmetic_op</span><span class="nt">(left, right, op, is_cmp)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_cmp</span> <span class="ow">and</span> <span class="p">(</span><span class="n">is_object_dtype</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span> <span class="ow">or</span> <span class="n">is_object_dtype</span><span class="p">(</span><span class="n">right</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span>         <span class="c1"># For object dtype, fallback to a masked operation (only operating</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>         <span class="c1">#  on the non-missing values)</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>         <span class="c1"># Don&#39;t do this for comparisons, as that will handle complex numbers</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span>         <span class="c1">#  incorrectly, see GH#32047</span>
<span class="ne">--&gt; </span><span class="mi">172</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">_masked_arith_op</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>         <span class="k">raise</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/ops/array_ops.py:110,</span> in <span class="ni">_masked_arith_op</span><span class="nt">(x, y, op)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="c1"># See GH#5284, GH#5035, GH#19448 for historical reference</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">result</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">xrav</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">yrav</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for -: &#39;str&#39; and &#39;str&#39;
</pre></div>
</div>
</div>
</div>
<p>Here, we’ll set up some helper code.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition-further-reading admonition">
<p class="admonition-title">Further Reading</p>
<p>For more on <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.color_palette.html">color palettes</a> see the seaborn docs</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>data_cols = [&#39;x0&#39;,&#39;x1&#39;]
def mu_to_df(mu,i):
    mu_df = pd.DataFrame(mu,columns=data_cols)
    mu_df[&#39;iteration&#39;] = str(i)
    mu_df[&#39;class&#39;] = [&#39;M&#39;+str(i) for i in range(K)]
    mu_df[&#39;type&#39;] = &#39;mu&#39;
    return mu_df

# color maps, we select every other value from this palette that has 8 values &amp; is paird
cmap_pt = sns.color_palette(&#39;tab20&#39;,8)[1::2] # starting from 1
cmap_mu = sns.color_palette(&#39;tab20&#39;,8)[0::2] # starting form 0
</pre></div>
</div>
</div>
</div>
<p>Now we can plot the data, save the axis, and plot the means on top of that.
Seaborn plotting functions return an axis, by saving that to a variable, we
can pass it to the <code class="docutils literal notranslate"><span class="pre">ax</span></code> parameter of another plotting function so that both
plotting functions go on the same figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sfig = sns.scatterplot(data=df,x=&#39;x0&#39;,y=&#39;x1&#39;, hue=&#39;0&#39;,
                       palette =cmap_pt,legend=False)
mu_df = mu_to_df(mu0,0)
sns.scatterplot(data=mu_df, x=&#39;x0&#39;,y=&#39;x1&#39;,hue=&#39;class&#39;,
                palette=cmap_mu,legend=False, ax=sfig)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sfig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                        <span class="n">palette</span> <span class="o">=</span><span class="n">cmap_pt</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">mu_df</span> <span class="o">=</span> <span class="n">mu_to_df</span><span class="p">(</span><span class="n">mu0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mu_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                 <span class="n">palette</span><span class="o">=</span><span class="n">cmap_mu</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">sfig</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/relational.py:742,</span> in <span class="ni">scatterplot</span><span class="nt">(data, x, y, hue, size, style, palette, hue_order, hue_norm, sizes, size_order, size_norm, markers, style_order, legend, ax, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">732</span> <span class="k">def</span> <span class="nf">scatterplot</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">733</span>     <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">734</span>     <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">738</span>     <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">739</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">741</span>     <span class="n">variables</span> <span class="o">=</span> <span class="n">_ScatterPlotter</span><span class="o">.</span><span class="n">get_semantics</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="ne">--&gt; </span><span class="mi">742</span>     <span class="n">p</span> <span class="o">=</span> <span class="n">_ScatterPlotter</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">744</span>     <span class="n">p</span><span class="o">.</span><span class="n">map_hue</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">hue_order</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">hue_norm</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">745</span>     <span class="n">p</span><span class="o">.</span><span class="n">map_size</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">size_order</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">size_norm</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/relational.py:538,</span> in <span class="ni">_ScatterPlotter.__init__</span><span class="nt">(self, data, variables, legend)</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">{},</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">530</span> 
<span class="g g-Whitespace">    </span><span class="mi">531</span>     <span class="c1"># TODO this is messy, we want the mapping to be agnostic about</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span>     <span class="c1"># the kind of plot to draw, but for the time being we need to set</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span>     <span class="c1"># this information so the SizeMapping can use it</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_default_size_range</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span>         <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.markersize&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">536</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">538</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span>     <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:640,</span> in <span class="ni">VectorPlotter.__init__</span><span class="nt">(self, data, variables)</span>
<span class="g g-Whitespace">    </span><span class="mi">635</span> <span class="c1"># var_ordered is relevant only for categorical axis variables, and may</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span> <span class="c1"># be better handled by an internal axis information object that tracks</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span> <span class="c1"># such information and is set up by the scale_* methods. The analogous</span>
<span class="g g-Whitespace">    </span><span class="mi">638</span> <span class="c1"># information for numeric axes would be information about log scales.</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_ordered</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>  <span class="c1"># alt., used DefaultDict</span>
<span class="ne">--&gt; </span><span class="mi">640</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_variables</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span> 
<span class="g g-Whitespace">    </span><span class="mi">644</span>     <span class="c1"># Create the mapping function</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>     <span class="n">map_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="n">plotter</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:701,</span> in <span class="ni">VectorPlotter.assign_variables</span><span class="nt">(self, data, variables)</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>     <span class="bp">self</span><span class="o">.</span><span class="n">input_format</span> <span class="o">=</span> <span class="s2">&quot;long&quot;</span>
<span class="ne">--&gt; </span><span class="mi">701</span>     <span class="n">plot_data</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variables_longform</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span>         <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:938,</span> in <span class="ni">VectorPlotter._assign_variables_longform</span><span class="nt">(self, data, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">933</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">934</span> 
<span class="g g-Whitespace">    </span><span class="mi">935</span>     <span class="c1"># This looks like a column name but we don&#39;t know what it means!</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Could not interpret value `</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">` for parameter `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">`&quot;</span>
<span class="ne">--&gt; </span><span class="mi">938</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">940</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">941</span> 
<span class="g g-Whitespace">    </span><span class="mi">942</span>     <span class="c1"># Otherwise, assume the value is itself data</span>
<span class="g g-Whitespace">    </span><span class="mi">943</span> 
<span class="g g-Whitespace">    </span><span class="mi">944</span>     <span class="c1"># Raise when data object is present and a vector can&#39;t matched</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>

<span class="ne">ValueError</span>: Could not interpret value `0` for parameter `hue`
</pre></div>
</div>
</div>
</div>
<p>We see that each point is assigned to the lighter shade of its matching mean.
These points are the one that is closest to each point, but they’re not the
centers of the point clouds.
Now, we can compute new means of the points assigned to each cluster, using
groupby.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>mu1 = df.groupby(&#39;0&#39;)[data_cols].mean().values
mu1
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mu1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)[</span><span class="n">data_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">mu1</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:8399,</span> in <span class="ni">DataFrame.groupby</span><span class="nt">(self, by, axis, level, as_index, sort, group_keys, squeeze, observed, dropna)</span>
<span class="g g-Whitespace">   </span><span class="mi">8396</span>     <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;You have to supply one of &#39;by&#39; and &#39;level&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">8397</span> <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_axis_number</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">8399</span> <span class="k">return</span> <span class="n">DataFrameGroupBy</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">8400</span>     <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8401</span>     <span class="n">keys</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8402</span>     <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8403</span>     <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8404</span>     <span class="n">as_index</span><span class="o">=</span><span class="n">as_index</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8405</span>     <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8406</span>     <span class="n">group_keys</span><span class="o">=</span><span class="n">group_keys</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8407</span>     <span class="n">squeeze</span><span class="o">=</span><span class="n">squeeze</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8408</span>     <span class="n">observed</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8409</span>     <span class="n">dropna</span><span class="o">=</span><span class="n">dropna</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">8410</span> <span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/groupby/groupby.py:959,</span> in <span class="ni">GroupBy.__init__</span><span class="nt">(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, squeeze, observed, mutated, dropna)</span>
<span class="g g-Whitespace">    </span><span class="mi">956</span> <span class="k">if</span> <span class="n">grouper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">957</span>     <span class="kn">from</span> <span class="nn">pandas.core.groupby.grouper</span> <span class="kn">import</span> <span class="n">get_grouper</span>
<span class="ne">--&gt; </span><span class="mi">959</span>     <span class="n">grouper</span><span class="p">,</span> <span class="n">exclusions</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">get_grouper</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">960</span>         <span class="n">obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">961</span>         <span class="n">keys</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">962</span>         <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">963</span>         <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">964</span>         <span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">965</span>         <span class="n">observed</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">966</span>         <span class="n">mutated</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mutated</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span>         <span class="n">dropna</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropna</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">968</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">970</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
<span class="g g-Whitespace">    </span><span class="mi">971</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_get_axis_number</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/groupby/grouper.py:888,</span> in <span class="ni">get_grouper</span><span class="nt">(obj, key, axis, level, sort, observed, mutated, validate, dropna)</span>
<span class="g g-Whitespace">    </span><span class="mi">886</span>         <span class="n">in_axis</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">gpr</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">gpr</span><span class="p">,</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">887</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">888</span>         <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">gpr</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">889</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gpr</span><span class="p">,</span> <span class="n">Grouper</span><span class="p">)</span> <span class="ow">and</span> <span class="n">gpr</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">890</span>     <span class="c1"># Add key to exclusions</span>
<span class="g g-Whitespace">    </span><span class="mi">891</span>     <span class="n">exclusions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gpr</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;0&#39;
</pre></div>
</div>
</div>
</div>
<p>We can plot these again, the same data, but with the new means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sfig = sns.scatterplot(data=df,x=&#39;x0&#39;,y=&#39;x1&#39;, hue=&#39;0&#39;,
                       palette =cmap_pt,legend=False)
mu_df = mu_to_df(mu1,0)
sns.scatterplot(data=mu_df, x=&#39;x0&#39;,y=&#39;x1&#39;,hue=&#39;class&#39;,
                palette=cmap_mu,legend=False, ax=sfig)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sfig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                        <span class="n">palette</span> <span class="o">=</span><span class="n">cmap_pt</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">mu_df</span> <span class="o">=</span> <span class="n">mu_to_df</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mu_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                 <span class="n">palette</span><span class="o">=</span><span class="n">cmap_mu</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">sfig</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/relational.py:742,</span> in <span class="ni">scatterplot</span><span class="nt">(data, x, y, hue, size, style, palette, hue_order, hue_norm, sizes, size_order, size_norm, markers, style_order, legend, ax, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">732</span> <span class="k">def</span> <span class="nf">scatterplot</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">733</span>     <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">734</span>     <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">738</span>     <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">739</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">741</span>     <span class="n">variables</span> <span class="o">=</span> <span class="n">_ScatterPlotter</span><span class="o">.</span><span class="n">get_semantics</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="ne">--&gt; </span><span class="mi">742</span>     <span class="n">p</span> <span class="o">=</span> <span class="n">_ScatterPlotter</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">744</span>     <span class="n">p</span><span class="o">.</span><span class="n">map_hue</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">hue_order</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">hue_norm</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">745</span>     <span class="n">p</span><span class="o">.</span><span class="n">map_size</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">size_order</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">size_norm</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/relational.py:538,</span> in <span class="ni">_ScatterPlotter.__init__</span><span class="nt">(self, data, variables, legend)</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">{},</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">530</span> 
<span class="g g-Whitespace">    </span><span class="mi">531</span>     <span class="c1"># TODO this is messy, we want the mapping to be agnostic about</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span>     <span class="c1"># the kind of plot to draw, but for the time being we need to set</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span>     <span class="c1"># this information so the SizeMapping can use it</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_default_size_range</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span>         <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.markersize&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">536</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">538</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span>     <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:640,</span> in <span class="ni">VectorPlotter.__init__</span><span class="nt">(self, data, variables)</span>
<span class="g g-Whitespace">    </span><span class="mi">635</span> <span class="c1"># var_ordered is relevant only for categorical axis variables, and may</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span> <span class="c1"># be better handled by an internal axis information object that tracks</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span> <span class="c1"># such information and is set up by the scale_* methods. The analogous</span>
<span class="g g-Whitespace">    </span><span class="mi">638</span> <span class="c1"># information for numeric axes would be information about log scales.</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_ordered</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>  <span class="c1"># alt., used DefaultDict</span>
<span class="ne">--&gt; </span><span class="mi">640</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_variables</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span> 
<span class="g g-Whitespace">    </span><span class="mi">644</span>     <span class="c1"># Create the mapping function</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>     <span class="n">map_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="n">plotter</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:701,</span> in <span class="ni">VectorPlotter.assign_variables</span><span class="nt">(self, data, variables)</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>     <span class="bp">self</span><span class="o">.</span><span class="n">input_format</span> <span class="o">=</span> <span class="s2">&quot;long&quot;</span>
<span class="ne">--&gt; </span><span class="mi">701</span>     <span class="n">plot_data</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variables_longform</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span>         <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:938,</span> in <span class="ni">VectorPlotter._assign_variables_longform</span><span class="nt">(self, data, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">933</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">934</span> 
<span class="g g-Whitespace">    </span><span class="mi">935</span>     <span class="c1"># This looks like a column name but we don&#39;t know what it means!</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Could not interpret value `</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">` for parameter `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">`&quot;</span>
<span class="ne">--&gt; </span><span class="mi">938</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">940</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">941</span> 
<span class="g g-Whitespace">    </span><span class="mi">942</span>     <span class="c1"># Otherwise, assume the value is itself data</span>
<span class="g g-Whitespace">    </span><span class="mi">943</span> 
<span class="g g-Whitespace">    </span><span class="mi">944</span>     <span class="c1"># Raise when data object is present and a vector can&#39;t matched</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>

<span class="ne">ValueError</span>: Could not interpret value `0` for parameter `hue`
</pre></div>
</div>
</div>
</div>
<p>We see that now the means are in the center of each cluster, but that there are
now points in one color that are assigned to other clusters.</p>
<p>So, again we can update the assignments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df[&#39;1&#39;] = pd.concat([((df[data_cols]-mu_i)**2).sum(axis=1) for mu_i in mu1],axis=1).idxmin(axis=1)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 df[&#39;1&#39;] = pd.concat([((df[data_cols]-mu_i)**2).sum(axis=1) for mu_i</span> in <span class="ni">mu1],axis=1).idxmin</span><span class="nt">(axis=1)</span>

<span class="ne">NameError</span>: name &#39;mu1&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>And plot again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sfig = sns.scatterplot(data=df,x=&#39;x0&#39;,y=&#39;x1&#39;, hue=&#39;0&#39;,
                       palette =cmap_pt,legend=False)
mu_df = mu_to_df(mu,0)
sns.scatterplot(data=mu_df, x=&#39;x0&#39;,y=&#39;x1&#39;,hue=&#39;class&#39;,
                palette=cmap_mu,legend=False, ax=sfig)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sfig</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                        <span class="n">palette</span> <span class="o">=</span><span class="n">cmap_pt</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">mu_df</span> <span class="o">=</span> <span class="n">mu_to_df</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mu_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                 <span class="n">palette</span><span class="o">=</span><span class="n">cmap_mu</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">sfig</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/relational.py:742,</span> in <span class="ni">scatterplot</span><span class="nt">(data, x, y, hue, size, style, palette, hue_order, hue_norm, sizes, size_order, size_norm, markers, style_order, legend, ax, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">732</span> <span class="k">def</span> <span class="nf">scatterplot</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">733</span>     <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">734</span>     <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">738</span>     <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">739</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">741</span>     <span class="n">variables</span> <span class="o">=</span> <span class="n">_ScatterPlotter</span><span class="o">.</span><span class="n">get_semantics</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
<span class="ne">--&gt; </span><span class="mi">742</span>     <span class="n">p</span> <span class="o">=</span> <span class="n">_ScatterPlotter</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">744</span>     <span class="n">p</span><span class="o">.</span><span class="n">map_hue</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">hue_order</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">hue_norm</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">745</span>     <span class="n">p</span><span class="o">.</span><span class="n">map_size</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">size_order</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">size_norm</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/relational.py:538,</span> in <span class="ni">_ScatterPlotter.__init__</span><span class="nt">(self, data, variables, legend)</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">{},</span> <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">530</span> 
<span class="g g-Whitespace">    </span><span class="mi">531</span>     <span class="c1"># TODO this is messy, we want the mapping to be agnostic about</span>
<span class="g g-Whitespace">    </span><span class="mi">532</span>     <span class="c1"># the kind of plot to draw, but for the time being we need to set</span>
<span class="g g-Whitespace">    </span><span class="mi">533</span>     <span class="c1"># this information so the SizeMapping can use it</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_default_size_range</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span>         <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.markersize&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">536</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">538</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span>     <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:640,</span> in <span class="ni">VectorPlotter.__init__</span><span class="nt">(self, data, variables)</span>
<span class="g g-Whitespace">    </span><span class="mi">635</span> <span class="c1"># var_ordered is relevant only for categorical axis variables, and may</span>
<span class="g g-Whitespace">    </span><span class="mi">636</span> <span class="c1"># be better handled by an internal axis information object that tracks</span>
<span class="g g-Whitespace">    </span><span class="mi">637</span> <span class="c1"># such information and is set up by the scale_* methods. The analogous</span>
<span class="g g-Whitespace">    </span><span class="mi">638</span> <span class="c1"># information for numeric axes would be information about log scales.</span>
<span class="g g-Whitespace">    </span><span class="mi">639</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_ordered</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>  <span class="c1"># alt., used DefaultDict</span>
<span class="ne">--&gt; </span><span class="mi">640</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_variables</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">642</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span> 
<span class="g g-Whitespace">    </span><span class="mi">644</span>     <span class="c1"># Create the mapping function</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>     <span class="n">map_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">map</span><span class="p">,</span> <span class="n">plotter</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:701,</span> in <span class="ni">VectorPlotter.assign_variables</span><span class="nt">(self, data, variables)</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span>     <span class="bp">self</span><span class="o">.</span><span class="n">input_format</span> <span class="o">=</span> <span class="s2">&quot;long&quot;</span>
<span class="ne">--&gt; </span><span class="mi">701</span>     <span class="n">plot_data</span><span class="p">,</span> <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_variables_longform</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span>         <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span> <span class="o">=</span> <span class="n">plot_data</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/seaborn/_oldcore.py:938,</span> in <span class="ni">VectorPlotter._assign_variables_longform</span><span class="nt">(self, data, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">933</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
<span class="g g-Whitespace">    </span><span class="mi">934</span> 
<span class="g g-Whitespace">    </span><span class="mi">935</span>     <span class="c1"># This looks like a column name but we don&#39;t know what it means!</span>
<span class="g g-Whitespace">    </span><span class="mi">937</span>     <span class="n">err</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Could not interpret value `</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">` for parameter `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">`&quot;</span>
<span class="ne">--&gt; </span><span class="mi">938</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">940</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">941</span> 
<span class="g g-Whitespace">    </span><span class="mi">942</span>     <span class="c1"># Otherwise, assume the value is itself data</span>
<span class="g g-Whitespace">    </span><span class="mi">943</span> 
<span class="g g-Whitespace">    </span><span class="mi">944</span>     <span class="c1"># Raise when data object is present and a vector can&#39;t matched</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>

<span class="ne">ValueError</span>: Could not interpret value `0` for parameter `hue`
</pre></div>
</div>
</div>
</div>
<p>If we keep going back and forth like this, eventually, the assignment step will
not change any assignments. We call this condition convergence. We can
implement the algorithm with a while loop.</p>
<div class="admonition-correction admonition">
<p class="admonition-title">Correction</p>
<p>In the following I swapped the order of the mean update and assignment steps.<br />
My previous version had a different <em>initialization</em> (the above part) so it
was okay for the steps to be in the other order.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>i =1
mu_list = [mu_to_df(mu0,i), mu_to_df(mu1,i)]
cur_old = str(i-1)
cur_new = str(i)
while sum(df[cur_old] !=df[cur_new]) &gt;0:
    cur_old = cur_new
    i +=1
    cur_new = str(i)
        #     update the means and plot with current generating assignments
    mu = df.groupby(cur_old)[data_cols].mean().values
    mu_df = mu_to_df(mu,i)
    mu_list.append(mu_df)

    fig = plt.figure()
    sfig = sns.scatterplot(data =df,x=&#39;x0&#39;,y=&#39;x1&#39;,hue=cur_old,palette=cmap_pt,legend=False)
    sns.scatterplot(data =mu_df,x=&#39;x0&#39;,y=&#39;x1&#39;,hue=&#39;class&#39;,palette=cmap_mu,ax=sfig,legend=False)


    #     update the assigments and plot with the associated means
    df[cur_new] = pd.concat([((df[data_cols]-mu_i)**2).sum(axis=1) for mu_i in mu],axis=1).idxmin(axis=1)
    fig = plt.figure()
    sfig = sns.scatterplot(data =df,x=&#39;x0&#39;,y=&#39;x1&#39;,hue=cur_new,palette=cmap_pt,legend=False)
    sns.scatterplot(data =mu_df,x=&#39;x0&#39;,y=&#39;x1&#39;,hue=&#39;class&#39;,palette=cmap_mu,ax=sfig,legend=False)


n_iter = i
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">i</span> <span class="o">=</span><span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">mu_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu_to_df</span><span class="p">(</span><span class="n">mu0</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">mu_to_df</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">i</span><span class="p">)]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">cur_old</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">cur_new</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="nn">Cell In[9], line 3,</span> in <span class="ni">mu_to_df</span><span class="nt">(mu, i)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">def</span> <span class="nf">mu_to_df</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="n">mu_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">data_cols</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">mu_df</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">mu_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)]</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/frame.py:721,</span> in <span class="ni">DataFrame.__init__</span><span class="nt">(self, data, index, columns, dtype, copy)</span>
<span class="g g-Whitespace">    </span><span class="mi">711</span>         <span class="n">mgr</span> <span class="o">=</span> <span class="n">dict_to_mgr</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">712</span>             <span class="c1"># error: Item &quot;ndarray&quot; of &quot;Union[ndarray, Series, Index]&quot; has no</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span>             <span class="c1"># attribute &quot;name&quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">718</span>             <span class="n">typ</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">719</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">720</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">721</span>         <span class="n">mgr</span> <span class="o">=</span> <span class="n">ndarray_to_mgr</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">722</span>             <span class="n">data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">723</span>             <span class="n">index</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">724</span>             <span class="n">columns</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">725</span>             <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">726</span>             <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">727</span>             <span class="n">typ</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">728</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">730</span> <span class="c1"># For data is list-like, or Iterable (will consume into list)</span>
<span class="g g-Whitespace">    </span><span class="mi">731</span> <span class="k">elif</span> <span class="n">is_list_like</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/construction.py:349,</span> in <span class="ni">ndarray_to_mgr</span><span class="nt">(values, index, columns, dtype, copy, typ)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span> <span class="c1"># _prep_ndarraylike ensures that values.ndim == 2 at this point</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span> <span class="n">index</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">_get_axes</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">346</span>     <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<span class="g g-Whitespace">    </span><span class="mi">347</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">349</span> <span class="n">_check_values_indices_shape_match</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">351</span> <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span>     <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/site-packages/pandas/core/internals/construction.py:420,</span> in <span class="ni">_check_values_indices_shape_match</span><span class="nt">(values, index, columns)</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span> <span class="n">passed</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span>
<span class="g g-Whitespace">    </span><span class="mi">419</span> <span class="n">implied</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">420</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of passed values is </span><span class="si">{</span><span class="n">passed</span><span class="si">}</span><span class="s2">, indices imply </span><span class="si">{</span><span class="n">implied</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: Shape of passed values is (4, 3), indices imply (4, 2)
</pre></div>
</div>
</div>
</div>
<p>This algorithm is random.  So each time we run it, it looks a little different.</p>
<p><img alt="scatterplot of gaussian data in 4 clusters running kmeans" src="../_images/demo_kmeans1.gif" /></p>
<p><img alt="scatterplot of gaussian data in 4 clusters running kmeans" src="../_images/demo_kmeans2.gif" /></p>
<p><img alt="scatterplot of gaussian data in 4 clusters running kmeans" src="../_images/demo_kmeans3.gif" /></p>
<p><img alt="scatterplot of gaussian data in 4 clusters running kmeans" src="../_images/demo_kmeans4.gif" /></p>
</section>
<section id="questions-after-class">
<h2><span class="section-number">23.3. </span>Questions After class<a class="headerlink" href="#questions-after-class" title="Permalink to this headline">#</a></h2>
<section id="are-there-any-better-way-to-optimize-than-run-multiple-times">
<h3><span class="section-number">23.3.1. </span>Are there any better way to optimize than run multiple times?<a class="headerlink" href="#are-there-any-better-way-to-optimize-than-run-multiple-times" title="Permalink to this headline">#</a></h3>
<p>Not totally, the Kmeans ++ algorithm for initialization will help, but sometimes just multiple times is all we have because there is so much more unknown than known.</p>
</section>
<section id="how-do-we-use-sklearn-to-cluster-data">
<h3><span class="section-number">23.3.2. </span>How do we use sklearn to cluster data?<a class="headerlink" href="#how-do-we-use-sklearn-to-cluster-data" title="Permalink to this headline">#</a></h3>
<p>We will see that Wednesday, but the short answer is that there is a an estimator object for the clustering model and then we use the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2022-10-28.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">22. </span>Sparse and Polynomial Regression</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2022-11-02.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">24. </span>Clustering with Sci-kit Learn</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Professor Sarah M Brown<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>